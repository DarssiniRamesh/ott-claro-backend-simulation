{"is_source_file": true, "format": "JavaScript", "description": "This file contains a user service implementation for handling user configurations and geolocation information based on IP addresses. It provides methods to retrieve user settings and enhanced error handling for geolocation lookups.", "external_files": ["./dataAccess"], "external_methods": ["dataAccess.readJsonFile"], "published": ["getHeaderInfo"], "classes": [], "methods": [{"name": "userConfig", "description": "Loads user configuration data from a JSON file."}, {"name": "getLocationInfo", "description": "Obtains location information based on IP address with validation and error handling."}, {"name": "getHeaderInfo", "description": "Generates header information based on client's IP address, includes location and session details."}], "calls": ["geoip.lookup", "moment.tz.zone", "moment().tz", "moment().clone"], "search-terms": ["userConfig", "getLocationInfo", "getHeaderInfo", "geolocation", "user configuration"], "state": 2, "file_id": 59, "knowledge_revision": 554, "git_revision": "f1bb1b93f798dd1a25a236427c260f187d926408", "revision_history": [{"304": ""}, {"308": ""}, {"335": "76506f74682f7a33bdda81916adb423a39a930e4"}, {"338": "76506f74682f7a33bdda81916adb423a39a930e4"}, {"341": "76506f74682f7a33bdda81916adb423a39a930e4"}, {"345": "76506f74682f7a33bdda81916adb423a39a930e4"}, {"346": "76506f74682f7a33bdda81916adb423a39a930e4"}, {"547": "f1bb1b93f798dd1a25a236427c260f187d926408"}, {"548": "f1bb1b93f798dd1a25a236427c260f187d926408"}, {"553": "f1bb1b93f798dd1a25a236427c260f187d926408"}, {"554": "f1bb1b93f798dd1a25a236427c260f187d926408"}], "ctags": [{"_type": "tag", "name": "config", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^  const config = userConfig();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^  const data = dataAccess.readJsonFile('user.json');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "dataAccess", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^const dataAccess = require('.\\/dataAccess');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "date", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^    date: localTime.format('YYYY-MM-DD'),$/", "language": "JavaScript", "kind": "property", "scope": "response", "scopeKind": "class"}, {"_type": "tag", "name": "geo", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^    const geo = geoip.lookup(ip);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "geoip", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^const geoip = require('geoip-lite');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getHeaderInfo", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^  getHeaderInfo$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "getHeaderInfo", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^const getHeaderInfo = async (clientIp) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getLocationInfo", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^const getLocationInfo = (ip) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "localTime", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^  const localTime = now.clone().tz(locationInfo.timezone);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "local_time", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^    local_time: localTime.format('YYYY-MM-DD HH:mm:ss Z'),  \\/\\/ Include timezone offset$/", "language": "JavaScript", "kind": "property", "scope": "response", "scopeKind": "class"}, {"_type": "tag", "name": "locationInfo", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^  const locationInfo = getLocationInfo(clientIp);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "moment", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^const moment = require('moment-timezone');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "now", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^        const now = moment();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "now", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^  const now = moment().tz('UTC');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "offset", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^    offset: localTime.format('Z')  \\/\\/ Add explicit offset information$/", "language": "JavaScript", "kind": "property", "scope": "response", "scopeKind": "class"}, {"_type": "tag", "name": "region", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^    const region = geo.region && \\/^[A-Z]{2}$\\/.test(geo.region)$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "region", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^    region: locationInfo.region,$/", "language": "JavaScript", "kind": "property", "scope": "response", "scopeKind": "class"}, {"_type": "tag", "name": "response", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^  const response = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "session_parametername", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^    session_parametername: 'HKS',$/", "language": "JavaScript", "kind": "property", "scope": "response", "scopeKind": "class"}, {"_type": "tag", "name": "session_stringvalue", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^    session_stringvalue: uuidv4(),$/", "language": "JavaScript", "kind": "property", "scope": "response", "scopeKind": "class"}, {"_type": "tag", "name": "time", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^    time: localTime.format('HH:mm:ss'),$/", "language": "JavaScript", "kind": "property", "scope": "response", "scopeKind": "class"}, {"_type": "tag", "name": "timezone", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^    let timezone = DEFAULT_TIMEZONE;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "timezone", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^    timezone: locationInfo.timezone,$/", "language": "JavaScript", "kind": "property", "scope": "response", "scopeKind": "class"}, {"_type": "tag", "name": "userConfig", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^const userConfig = () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "utc", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^    utc: now.toISOString(),  \\/\\/ Use ISO format for better compatibility$/", "language": "JavaScript", "kind": "property", "scope": "response", "scopeKind": "class"}, {"_type": "tag", "name": "zone", "path": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "pattern": "/^      const zone = moment.tz.zone(geo.timezone);$/", "language": "JavaScript", "kind": "constant"}], "filename": "/home/kavia/workspace/ott-claro-backend-simulation/services/userService.js", "hash": "8fb04729864c8e467ca137ff82660c9d", "format-version": 4, "code-base-name": "default", "fields": [{"name": "date: localTime.format('YYYY-MM-DD'),", "scope": "response", "scopeKind": "class", "description": "unavailable"}, {"name": "getHeaderInfo", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}, {"name": "local_time: localTime.format('YYYY-MM-DD HH:mm:ss Z'),  \\/\\/ Include timezone offset", "scope": "response", "scopeKind": "class", "description": "unavailable"}, {"name": "offset: localTime.format('Z')  \\/\\/ Add explicit offset information", "scope": "response", "scopeKind": "class", "description": "unavailable"}, {"name": "region: locationInfo.region,", "scope": "response", "scopeKind": "class", "description": "unavailable"}, {"name": "session_parametername: 'HKS',", "scope": "response", "scopeKind": "class", "description": "unavailable"}, {"name": "session_stringvalue: uuidv4(),", "scope": "response", "scopeKind": "class", "description": "unavailable"}, {"name": "time: localTime.format('HH:mm:ss'),", "scope": "response", "scopeKind": "class", "description": "unavailable"}, {"name": "let timezone = DEFAULT_TIMEZONE;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "timezone: locationInfo.timezone,", "scope": "response", "scopeKind": "class", "description": "unavailable"}, {"name": "utc: now.toISOString(),  \\/\\/ Use ISO format for better compatibility", "scope": "response", "scopeKind": "class", "description": "unavailable"}]}